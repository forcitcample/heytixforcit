jQuery(document).ready(function(a){function b(a,b){var d=a.find(".bundle_data");return d.data("update_lock")===!0?!1:(d.data("update_lock",!0),void window.setTimeout(function(){c(a,b),d.data("update_lock",!1)},50))}function c(b,c){"undefined"==typeof c&&(c=!1);var g=!0,h={},i={},j=b.find(".bundle_data").data("bundle_price_data");if("undefined"!=typeof b.find(".bundle_data").data("stock_status")?b.find(".bundle_data .bundle_wrap p.stock").replaceWith(b.find(".bundle_data").data("stock_status")):b.find(".bundle_data .bundle_wrap p.stock").remove(),b.find(".bundled_product .cart").each(function(){var c=a(this),d=c.attr("data-bundled_item_id"),e=c.find("input.qty").val();return"undefined"==typeof d&&(d=c.attr("data-bundled-item-id")),i[d]=1==c.data("optional")&&0==c.data("optional_status")?0:e,"variable"==c.data("type")&&""==c.find('.bundled_item_wrap input[name="variation_id"]').val()&&(b.find(".bundle_data .bundle_wrap").find("input.bundle_variation_id_"+d).val(""),j.prices[d]=0,j.regular_prices[d]=0,0==c.data("optional")||1==c.data("optional_status"))?(g=!1,!1):void 0}),g){var k=parseInt(b.find(".bundle_data .bundle_button input.qty").val());if(b.find(".bundled_product .cart").each(function(){var b=a(this),c=b.attr("data-bundled_item_id");"undefined"==typeof c&&(c=b.attr("data-bundled-item-id")),h[c]=0,b.find(".addon").each(function(){var b=0;a(this).is(".addon-custom-price")?b=a(this).val():a(this).is(".addon-input_multiplier")?(isNaN(a(this).val())||""==a(this).val()?(a(this).val(""),a(this).closest("p").find(".addon-alert").show()):(""!=a(this).val()&&a(this).val(Math.ceil(a(this).val())),a(this).closest("p").find(".addon-alert").hide()),b=a(this).data("price")*a(this).val()):a(this).is(".addon-checkbox, .addon-radio")?a(this).is(":checked")&&(b=a(this).data("price")):a(this).is(".addon-select")?a(this).val()&&(b=a(this).find("option:selected").data("price")):a(this).val()&&(b=a(this).data("price")),b||(b=0),h[c]=parseFloat(h[c])+parseFloat(b)}),a(this).data("quantity",i[c])}),j.per_product_pricing===!1&&""===j.total)return void d(b,wc_bundle_params.i18n_unavailable_text);if(1==j.per_product_pricing){j.total=0,j.regular_total=0;for(var l in j.prices)j.total+=(parseFloat(j.prices[l])+parseFloat(h[l]))*i[l],j.regular_total+=(parseFloat(j.regular_prices[l])+parseFloat(h[l]))*i[l]}else{j.total_backup=parseFloat(j.total),j.regular_total_backup=parseFloat(j.regular_total);for(var m in h)j.total+=parseFloat(h[m])*i[m],j.regular_total+=parseFloat(h[m])*i[m]}var n=b.find(".bundle_data #product-addons-total");n.length>0&&(n.data("price",j.total),b.find(".bundle_data").trigger("woocommerce-product-addons-update"));var o=!1;if(j.bundle_is_composited===!0){var p=b.closest(".composite_form").find(".composite_data").data("price_data");o=p.per_product_pricing,wc_bundle_params.i18n_total=wc_bundle_params.i18n_subtotal}if(j.per_product_pricing===!0||j.bundle_is_composited===!0&&o===!0)if(0==j.total&&1==j.show_free_string)b.find(".bundle_data .bundle_price").html('<p class="price"><span class="total">'+wc_bundle_params.i18n_total+"</span>"+wc_bundle_params.i18n_free+"</p>");else{var q=e(f(k*j.total)),r=e(f(k*j.regular_total));b.find(".bundle_data .bundle_price").html(j.regular_total>j.total?'<p class="price">'+j.price_string.replace("%s",'<span class="total">'+wc_bundle_params.i18n_total+"</span><del>"+r+"</del> <ins>"+q+"</ins>")+"</p>":'<p class="price">'+j.price_string.replace("%s",'<span class="total">'+wc_bundle_params.i18n_total+"</span>"+q)+"</p>");var s=b.find('.bundled_product .cart[data-type="subscription"]');s.length>0&&(s.each(function(){var c=a(this),d=c.attr("data-bundled_item_id");"undefined"==typeof d&&(d=c.attr("data-bundled-item-id")),i[d]>0&&(b.find(".bundle_data .bundle_price .bundled_subscriptions_price_html").show(),b.find(".bundle_data .bundle_price .bundled_sub_price_html_"+d).show().addClass("visible"))}),b.find(".bundle_data .bundle_price .bundled_subscriptions_price_html .bundled_sub_price_html.visible").first().find(".plus").hide())}else b.find(".bundle_data .bundle_price").html("");b.find(".bundled_product .cart").each(function(){if(1==a(this).data("optional")&&0==a(this).data("optional_status"))return!0;var c=a(this).find("p.stock");c.hasClass("out-of-stock")&&(b.find(".bundle_data .bundle_wrap p.stock").length>0?b.find(".bundle_data .bundle_wrap p.stock").replaceWith(c.clone().html(wc_bundle_params.i18n_partially_out_of_stock)):b.find(".bundle_data .bundle_wrap .bundle_price").after(c.clone().html(wc_bundle_params.i18n_partially_out_of_stock))),c.hasClass("available-on-backorder")&&!b.find(".bundle_data .bundle_wrap p.stock").hasClass("out-of-stock")&&(b.find(".bundle_data .bundle_wrap p.stock").length>0?b.find(".bundle_data .bundle_wrap p.stock").replaceWith(c.clone().html(wc_bundle_params.i18n_partially_on_backorder)):b.find(".bundle_data .bundle_wrap .bundle_price").after(c.clone().html(wc_bundle_params.i18n_partially_on_backorder)))}),b.find(".bundle_data .bundle_wrap p.stock").hasClass("out-of-stock")?b.find(".bundle_data .bundle_button button").prop("disabled",!0).addClass("disabled"):b.find(".bundle_data .bundle_button button").prop("disabled",!1).removeClass("disabled");var t=b.find(".bundle_data").data("button_behaviour");"new"!==t&&b.find(".bundle_data .bundle_wrap").slideDown(200),b.find(".bundle_data .bundle_wrap").trigger("woocommerce-product-bundle-show"),b.find(".component_data").data("price",j.total),b.find(".component_data").data("regular_price",j.regular_total),b.find(".component_data").data("component_set",!0),j.total=j.total_backup,j.regular_total=j.regular_total_backup}else c||d(b);b.find(".bundle_data .bundle_wrap").trigger("woocommerce-composited-product-update")}function d(a,b){"undefined"==typeof b&&(b=wc_bundle_params.i18n_select_options),a.find(".component_data").data("component_set",!1);var c=a.find(".bundle_data").data("button_behaviour");"new"==c?(a.find(".bundle_data .bundle_price").html(b),a.find(".bundle_data .bundle_button button").prop("disabled",!0).addClass("disabled")):a.find(".bundle_data .bundle_wrap").slideUp(200),a.find(".bundle_data .bundle_wrap").trigger("woocommerce-product-bundle-hide")}function e(a){var b=wc_bundle_params.currency_format_decimal_sep,c=wc_bundle_params.currency_position,d=wc_bundle_params.currency_symbol,e=wc_bundle_params.currency_format_trim_zeros,f=wc_bundle_params.currency_format_num_decimals;if("yes"==e&&f>0){for(var g=0;f>g;g++)b+="0";a=a.replace(b,"")}var h="";return"left"==c?h='<span class="amount">'+d+a+"</span>":"right"==c?h='<span class="amount">'+a+d+"</span>":"left_space"==c?h='<span class="amount">'+d+" "+a+"</span>":"right_space"==c&&(h='<span class="amount">'+a+" "+d+"</span>"),h}function f(a){var b=wc_bundle_params.currency_format_num_decimals,c=wc_bundle_params.currency_format_decimal_sep,d=wc_bundle_params.currency_format_thousand_sep,e=a,f=isNaN(b=Math.abs(b))?2:b,g=void 0==c?",":c,h=void 0==d?".":d,i=0>e?"-":"",j=parseInt(e=Math.abs(+e||0).toFixed(f))+"",k=(k=j.length)>3?k%3:0;return i+(k?j.substr(0,k)+h:"")+j.substr(k).replace(/(\d{3})(?=\d)/g,"$1"+h)+(f?g+Math.abs(e-j).toFixed(f).slice(2):"")}a("body").on("quick-view-displayed",function(){a(".bundle_form .bundle_data").each(function(){a(this).wc_pb_bundle_form()})}),a.fn.wc_pb_bundle_form=function(){a(".bundled_product").on("change","input.bundled_qty",function(c){var d=a(this).closest(".bundle_form"),e=parseFloat(a(this).attr("min")),f=parseFloat(a(this).attr("max"));e>=0&&parseFloat(a(this).val())<e&&a(this).val(e),f>0&&parseFloat(a(this).val())>f&&a(this).val(f),b(d)}).on("change",".bundled_product_optional_checkbox input",function(c){var d=a(this).closest(".bundle_form");a(this).is(":checked")?(a(this).closest(".bundled_product").find(".bundled_item_optional_content, .bundled_item_cart_content").slideDown(200),a(this).closest(".bundled_product").find(".cart").data("optional_status",!0),a(this).closest(".bundled_product").find(".variations_form .variations select").trigger("change")):(a(this).closest(".bundled_product").find(".bundled_item_optional_content, .bundled_item_cart_content").slideUp(200),a(this).closest(".bundled_product").find(".cart").data("optional_status",!1),a(this).closest(".bundled_product").find(".bundled_product_images").addClass("images"),a(this).closest(".bundled_product").find(".variations_form").trigger("reset_image"),a(this).closest(".bundled_product").find(".bundled_product_images").removeClass("images")),b(d),c.stopPropagation()}).on("found_variation",function(c,d){var e=a(this).find(".variations_form"),f=e.closest(".bundle_form"),g=e.attr("data-bundled_item_id");"undefined"==typeof g&&(g=e.attr("data-bundled-item-id"));var h=f.find(".bundle_data").data("bundle_price_data");1==h.per_product_pricing&&(h.prices[g]=d.price,h.regular_prices[g]=d.regular_price),f.find(".bundle_data .bundle_wrap").find("input.bundle_variation_id_"+g).val(d.variation_id).change();for(var i in d.attributes){var j=i.replace(/%/g,"\\%");f.find(".bundle_data .bundle_wrap").find("input.bundle_"+j+"_"+g).val(e.find('select[name="'+j+'"]').val())}a(this).find(".bundled_product_images").removeClass("images"),b(f),c.stopPropagation()}).on("reset_image",function(b){a(this).find(".bundled_product_images").removeClass("images")}).on("woocommerce-product-addons-update",function(a){a.stopPropagation()}).on("woocommerce_variation_select_focusin",function(a){a.stopPropagation()}).on("woocommerce_variation_select_change",function(c){var d=a(this).find(".cart"),e=a(this).find(".variations_form"),f=e.closest(".bundle_form");(0==d.data("optional")||1==d.data("optional_status"))&&a(this).find(".bundled_product_images").addClass("images"),a(this).find(".variations .attribute-options select").each(function(){return""===a(this).val()?(e.find(".bundled_item_wrap .single_variation").html(""),b(f),!1):void 0}),c.stopPropagation()}),a(".bundled_product .cart").on("woocommerce-product-addons-update",function(c){var d=a(this).closest(".cart"),e=d.closest(".bundle_form");b(e,!0),c.stopPropagation()}).on("woocommerce-nyp-updated-item",function(c){var d=a(this),e=d.closest(".bundle_form"),f=d.attr("data-bundled_item_id"),g=d.find(".nyp");if("undefined"==typeof f&&(f=d.attr("data-bundled-item-id")),g.is(":visible")){var h=e.find(".bundle_data").data("bundle_price_data");h.prices[f]=g.data("price"),b(e)}c.stopPropagation()}),a(".bundle_data").on("woocommerce-nyp-updated-item",function(c){var d=a(this),e=d.closest(".bundle_form"),f=d.find(".nyp");if(f.is(":visible")){var g=e.find(".bundle_data").data("bundle_price_data");g.total=f.data("price"),b(e)}c.stopPropagation()}).on("change",".bundle_button input.qty",function(c){var d=a(this),e=d.closest(".bundle_form");b(e)});var c=a(this).find("#product-addons-total");a(this).find(".bundle_price").after(c),a(this).find(".bundle_wrap p.stock").length>0&&this.data("stock_status",a(this).find(".bundle_wrap p.stock").clone().wrap("<p>").parent().html()),a(this).parent().find(".bundled_product").each(function(){var b=a(this).find(".cart");a(this).find(".bundled_product_optional_checkbox input").change(),"variable"!=b.data("type")||b.hasClass("variations_form")||(b.addClass("variations_form").wc_variation_form(),b.find(".variations select").change())}),b(a(this).closest(".bundle_form"))},a(".bundle_form .bundle_data").each(function(){a(this).wc_pb_bundle_form()})});